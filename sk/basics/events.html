
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="sk">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Event System Architecture &#8212; Dokumentácia Webino 0.1.0alpha</title>
    <link rel="stylesheet" href="../_static/better.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Hľadať" href="../search.html" />
    <link rel="next" title="Application Context" href="application-context.html" />
    <link rel="prev" title="Services Architecture" href="services.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../_static/common.css" type="text/css" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&subset=latin,latin-ext" type="text/css" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,700&subset=latin,latin-ext" type="text/css" />
  </head>
  <body>
  <div class="related top">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="services.html" title="Previous document">Services Architecture</a>
        </li>
        <li>
          <a href="application-context.html" title="Next document">Application Context</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="../index.html">Dokumentácia Webino 0.1.0alpha</a></li> 
    </ul>
  </nav>
  </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="event-system-architecture">
<h1>Event System Architecture<a class="headerlink" href="#event-system-architecture" title="Trvalý odkaz na tento nadpis">¶</a></h1>
<div class="contents local topic" id="obsah">
<ul class="simple">
<li><a class="reference internal" href="#event-lifecycle" id="id2">Event Lifecycle</a></li>
<li><a class="reference internal" href="#event-listeners" id="id3">Event Listeners</a></li>
<li><a class="reference internal" href="#core-listeners" id="id4">Core Listeners</a></li>
</ul>
</div>
<p>The Webino™ architecture is event driven, thus extensible. We can attach listeners to events,
performing other operations as they trigger.</p>
<div class="section" id="event-lifecycle">
<h2><a class="toc-backref" href="#id2">Event Lifecycle</a><a class="headerlink" href="#event-lifecycle" title="Trvalý odkaz na tento nadpis">¶</a></h2>
<p>The basic idea around events is that we just trigger an event and every action happens in listeners,
even the main action. Then we can listen to that event using priorities, if we want to act like a middleware.
The event propagation could be stopped at any time.</p>
<img alt="../_images/WebinoEventLib.Event.Lifecycle_h400.png" class="centered" src="../_images/WebinoEventLib.Event.Lifecycle_h400.png" />
<p>Using events like <em>someEvent.pre</em> and <em>someEvent.post</em> or <em>someEvent.before</em>, <em>someEvent.after</em>, it doesn’t matter,
is messy and not recommended, don’t do that. Give an event a unique name then attach listeners using priorities.
Convenient way to do that is to use an event <a class="reference internal" href="../guide/events.html#api-events-priority"><span class="std std-ref">priority constants</span></a>.</p>
</div>
<div class="section" id="event-listeners">
<span id="architecture-events-event-listeners"></span><h2><a class="toc-backref" href="#id3">Event Listeners</a><a class="headerlink" href="#event-listeners" title="Trvalý odkaz na tento nadpis">¶</a></h2>
<p>The event listener is a callable piece of code that can perform actions when event is emitted.
It is allowed to register an event listeners in some different ways.</p>
<div class="contents local topic" id="id1">
<ul class="simple">
<li><a class="reference internal" href="#closure-listener" id="id5">Closure Listener</a></li>
<li><a class="reference internal" href="#invokable-listener" id="id6">Invokable Listener</a></li>
<li><a class="reference internal" href="#listener-aggregate" id="id7">Listener Aggregate</a></li>
</ul>
</div>
<div class="section" id="closure-listener">
<h3><a class="toc-backref" href="#id5">Closure Listener</a><a class="headerlink" href="#closure-listener" title="Trvalý odkaz na tento nadpis">¶</a></h3>
<p>The closure listener is the fastest created listener, but not the best practice at all.</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">WebinoEventLib\Event</span><span class="p">;</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;someEvent&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Event</span> <span class="nv">$event</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something...</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="invokable-listener">
<h3><a class="toc-backref" href="#id6">Invokable Listener</a><a class="headerlink" href="#invokable-listener" title="Trvalý odkaz na tento nadpis">¶</a></h3>
<p>The invokable listener is a class that its object can be called like a function.</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">WebinoEventLib\Event</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyInvokableListener</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(</span><span class="nx">Event</span> <span class="nv">$event</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// do something...</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// lazy loading</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;someEvent&#39;</span><span class="p">,</span> <span class="nx">MyInvokableListener</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>

<span class="c1">// as object</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;someEvent&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">MyInvokableListener</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="listener-aggregate">
<h3><a class="toc-backref" href="#id7">Listener Aggregate</a><a class="headerlink" href="#listener-aggregate" title="Trvalý odkaz na tento nadpis">¶</a></h3>
<p>The listener aggregate is a class that registers other listeners in a batch.</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">WebinoEventLib\Event</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">WebinoEventLib\Listener\AbstractListener</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyListenerAggregate</span> <span class="k">extends</span> <span class="nx">AbstractListener</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">init</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// handle an event by itself</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">listen</span><span class="p">(</span><span class="s1">&#39;someEvent&#39;</span><span class="p">,</span> <span class="s1">&#39;onSomeEvent&#39;</span><span class="p">);</span>

        <span class="c1">// handle an event by closure</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">listen</span><span class="p">(</span><span class="s1">&#39;someEvent&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Event</span> <span class="nv">$event</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// do something...</span>
        <span class="p">});</span>

        <span class="c1">// handle an event by invokable</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">listen</span><span class="p">(</span><span class="s1">&#39;someEvent&#39;</span><span class="p">,</span> <span class="nx">SomeInvokableListener</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>

        <span class="c1">// handle an event by its collaborator</span>
        <span class="nv">$eventProcessor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\MyEventProcessor</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">listen</span><span class="p">(</span><span class="s1">&#39;someEvent&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nv">$eventProcessor</span><span class="p">,</span> <span class="s1">&#39;onEvent&#39;</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">onSomeEvent</span><span class="p">(</span><span class="nx">Event</span> <span class="nv">$event</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// do something...</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// lazy loading</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="nx">MyListenerAggregate</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>

<span class="c1">// as object</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="k">new</span> <span class="nx">MyListenerAggregate</span><span class="p">);</span>
</pre></div>
</div>
<p>Registering listener aggregates via application config.</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">WebinoAppLib\Feature\Listener</span><span class="p">;</span>

<span class="nx">Webino</span><span class="o">::</span><span class="na">config</span><span class="p">([</span>
    <span class="c1">// invokable</span>
    <span class="k">new</span> <span class="nx">Listener</span><span class="p">(</span><span class="nx">MyListenerAggregate</span><span class="o">::</span><span class="na">class</span><span class="p">),</span>
    <span class="c1">// factory</span>
    <span class="k">new</span> <span class="nx">Listener</span><span class="p">(</span><span class="nx">MyListenerAggregate</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="nx">MyListenerAggregateFactory</span><span class="o">::</span><span class="na">class</span><span class="p">),</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="core-listeners">
<span id="architecture-events-core-listeners"></span><h2><a class="toc-backref" href="#id4">Core Listeners</a><a class="headerlink" href="#core-listeners" title="Trvalý odkaz na tento nadpis">¶</a></h2>
<p>Core listeners can even listen to the application bootstrap first pass and configure events. They are registered into
the core configuration and they can modify application configuration.</p>
<div class="admonition note">
<p class="first admonition-title">Poznámka</p>
<p class="last">Only core services are available to core listeners before application is fully bootstrapped.</p>
</div>
<p>Registering core listener aggregate via application config.</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">WebinoAppLib\Feature\CoreListener</span><span class="p">;</span>

<span class="nx">Webino</span><span class="o">::</span><span class="na">config</span><span class="p">([</span>
    <span class="c1">// invokable</span>
    <span class="k">new</span> <span class="nx">CoreListener</span><span class="p">(</span><span class="nx">MyListenerAggregate</span><span class="o">::</span><span class="na">class</span><span class="p">),</span>
    <span class="c1">// factory</span>
    <span class="k">new</span> <span class="nx">CoreListener</span><span class="p">(</span><span class="nx">MyListenerAggregate</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="nx">MyListenerAggregateFactory</span><span class="o">::</span><span class="na">class</span><span class="p">),</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/webino.png" alt="Logo"/>
            </a></p><menu>
    <h2>Getting Started</h2>
    <ul>
        <li>
            <a href="../index.html">Introduction</a>
        </li>
        <li>
            <a href="http://demo.webino.org">Examples</a>
        </li>
        <li>
            <a href="../requirements.html">Requirements [TODO]</a>
        </li>
        <li>
            <a href="../installation.html">Installation [TODO]</a>
        </li>
        <li>
            <a href="../available-modules.html">Available Modules [TODO]</a>
        </li>
    </ul>

    <h2>The Basics</h2>
    <ul>
        <li>
            <a href="basic-usage.html">Basic Usage</a>
        </li>
        <li>
            <a href="application.html">Application Architecture</a>
        </li>
        <li>
            <a href="configuration.html">Configuration Basics</a>
        </li>
        <li>
            <a href="services.html">Services Architecture</a>
        </li>
        <li>
            <a href="#">Event System</a>
        </li>
        <li>
            <a href="application-context.html">Application Context [TODO]</a>
        </li>
        <li>
            <a href="application-modules.html">Application Modules [TODO]</a>
        </li>
        <li>
            <a href="skeleton-application.html">Skeleton Application [TODO]</a>
        </li>
        <li>
            <a href="templates.html">Templates [TODO]</a>
        </li>
        <li>
            <a href="public-assets.html">Public Assets [TODO]</a>
        </li>
        <li>
            <a href="command-line-interface.html">Command Line Interface</a>
        </li>
    </ul>

    <h2>User Guide</h2>
    <ul>
        <li>
            <a href="../guide/config.html">Config</a>
        </li>
        <li>
            <a href="../guide/services.html">Services</a>
        </li>
        <li>
            <a href="../guide/events.html">Events</a>
        </li>
        <li>
            <a href="../guide/debugging.html">Debugging</a>
        </li>
        <li>
            <a href="../guide/logging.html">Logging</a>
        </li>
        <li>
            <a href="../guide/caching.html">Caching [TODO]</a>
        </li>
        <li>
            <a href="../guide/filesystem.html">Filesystem</a>
        </li>
        <li>
            <a href="../guide/routing.html">Routing</a>
        </li>
        <li>
            <a href="../guide/requests.html">Requests [TODO]</a>
        </li>
        <li>
            <a href="../guide/responses.html">Responses</a>
        </li>
        <li>
            <a href="../guide/sessions.html">Sessions [TODO]</a>
        </li>
        <li>
            <a href="../guide/database.html">Database [TODO]</a>
        </li>
        <li>
            <a href="../guide/mailer.html">Mailer [TODO]</a>
        </li>
        <li>
            <a href="../guide/templates.html">Templates [TODO]</a>
        </li>
        <li>
            <a href="../guide/assets.html">Assets [TODO]</a>
        </li>
        <li>
            <a href="../guide/localization.html">Localization [TODO]</a>
        </li>
        <li>
            <a href="../guide/console.html">Console</a>
        </li>
        <li>
            <hr/>
        </li>
        <li>
            <a href="../guide/html-helpers.html">HTML helpers [TODO]</a>
        </li>
        <li>
            <a href="../guide/html-helpers.html">Document Object Model [TODO]</a>
        </li>
    </ul>

    <h2>Delivery</h2>
    <ul>
        <li>
            <a href="../delivery/application-build.html">Application Build [TODO]</a>
        </li>
        <li>
            <a href="../delivery/continuous-integration.html">Continuous Integration [TODO]</a>
        </li>
        <li>
            <a href="../delivery/continuous-delivery.html">Continuous Delivery [TODO]</a>
        </li>
    </ul>

    <h2>Development</h2>
    <ul>
        <li>
            <a href="../development/api-docs.html">API Docs [TODO]</a>
        </li>
        <li>
            <a href="../development/roadmap.html">Roadmap [TODO]</a>
        </li>
        <li>
            <a href="../development/release-notes.html">Release Notes [TODO]</a>
        </li>
        <li>
            <a href="../development/upgrade-guide.html">Upgrade Guide [TODO]</a>
        </li>
        <li>
            <a href="../development/contribution-guide.html">Contribution guide [TODO]</a>
        </li>
    </ul>
</menu>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="related bottom">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="services.html" title="Previous document">Services Architecture</a>
        </li>
        <li>
          <a href="application-context.html" title="Next document">Application Context</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="../index.html">Dokumentácia Webino 0.1.0alpha</a></li> 
    </ul>
  </nav>
  </div>
  <footer id="pagefooter">&copy; 2015, Webino, s. r. o. All rights reserved.

  </footer>

  
  </body>
</html>